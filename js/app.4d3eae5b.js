(function(t){function e(e){for(var n,s,o=e[0],l=e[1],c=e[2],u=0,f=[];u<o.length;u++)s=o[u],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&f.push(a[s][0]),a[s]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);d&&d(e);while(f.length)f.shift()();return i.push.apply(i,c||[]),r()}function r(){for(var t,e=0;e<i.length;e++){for(var r=i[e],n=!0,o=1;o<r.length;o++){var l=r[o];0!==a[l]&&(n=!1)}n&&(i.splice(e--,1),t=s(s.s=r[0]))}return t}var n={},a={app:0},i=[];function s(e){if(n[e])return n[e].exports;var r=n[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=t,s.c=n,s.d=function(t,e,r){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(r,n,function(e){return t[e]}.bind(null,n));return r},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/ArVerify/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var d=l;i.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("56d7")},"56d7":function(t,e,r){"use strict";r.r(e);var n=r("2b0e"),a=r("bc3a"),i=r.n(a);let s={};const o=i.a.create(s);o.interceptors.request.use((function(t){return t}),(function(t){return Promise.reject(t)})),o.interceptors.response.use((function(t){return t}),(function(t){return Promise.reject(t)})),Plugin.install=function(t,e){t.axios=o,window.axios=o,Object.defineProperties(t.prototype,{axios:{get(){return o}},$axios:{get(){return o}}})},n["a"].use(Plugin);Plugin;var l=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"app"}},[r("router-view")],1)},c=[],d=r("2877"),u={},f=Object(d["a"])(u,l,c,!1,null,null,null),p=f.exports,v=r("8c4f"),g=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"p-4"},[r("navigation",{attrs:{"logged-in":t.loggedIn}}),t.loggedIn?r("div",[r("wallet-information"),r("h-bar"),r("status"),r("h-bar")],1):r("div",[r("login")],1)],1)},h=[],m=r("95dc"),w=r.n(m);const b=w.a.init({host:"arweave.net",port:443,protocol:"https",timeout:2e4,logging:!1});function y(){return!!localStorage.getItem("jwk")}async function x(){let t=JSON.parse(localStorage.getItem("jwk"));return t?await b.wallets.jwkToAddress(t):void 0}async function _(){let t=await x();if(t){let e=await b.wallets.getBalance(t);return b.ar.winstonToAr(e)}}var T=b,j=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{staticClass:"flex items-stretch"},[r("div",{staticClass:"w-1/2 text-6xl font-bold"},[t._v("ArVerify.")]),r("div",{staticClass:"w-1/2 self-center text-right"},[t.loggedIn?r("button",{on:{click:t.logout}},[t._v("Logout")]):t._e()])])])},C=[],S={name:"Navigation",props:["loggedIn"],methods:{logout(){localStorage.clear(),location.reload()}}},O=S,P=Object(d["a"])(O,j,C,!1,null,"cb2f450a",null),k=P.exports,$=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"flex flex-col justify-center"},[r("div",{staticClass:"flex justify-center"},[r("div",{staticClass:"self-center px-6 font-bold text-3xl"},[t._v("{")]),r("div",{staticClass:"self-center font-light"},[t._v(t._s(t.address))]),r("div",{staticClass:"self-center px-6 font-bold text-3xl"},[t._v("}")])]),r("h-bar"),r("div",{staticClass:"px-48"},[r("div",{staticClass:"text-center font-bold text-lg"},[t._v("Your Balance.")]),r("div",{staticClass:"bg-gray-500 py-5"},[r("div",{staticClass:"text-center text-white font-light text-2xl"},[t._v(t._s(t.balance)+" AR")])])])],1)},F=[],V=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},I=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"divide-y-2 divide-black divide-dashed"},[r("div",{staticClass:"h-1"}),r("div",{staticClass:"h-1"})])}],N={name:"HBar"},H=N,A=Object(d["a"])(H,V,I,!1,null,"641c468d",null),q=A.exports,E={name:"WalletInformation",components:{HBar:q},data(){return{address:void 0,balance:void 0}},async mounted(){this.address=await x(),this.balance=await _()}},W=E,G=Object(d["a"])(W,$,F,!1,null,"3df5c2de",null),Y=G.exports,J=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"flex flex-col justify-center"},[r("div",{staticClass:"text-center font-bold text-2xl"},[t._v("Your Status.")]),r("div",{class:"text-center font-bold text-2xl text-"+t.mode.color+"-700"},[t._v(t._s(t.mode.statusText))]),r("div",[r("div",{staticClass:"flex justify-center"},[r("status-circle",{attrs:{color:t.mode.color,"button-html":t.mode.buttonHtml,verified:t.verified},on:{clicked:t.verify}})],1)])])},R=[],B=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{class:"border border-dashed border-"+t.color+"-700 rounded-full p-4 "+(t.verified?"cursor-default":"cursor-pointer"),on:{click:function(e){return t.$emit("clicked")}}},[r("div",{class:"border-20 border-"+t.color+"-700 rounded-full"},[r("div",{staticClass:"h-48 w-48"},[r("div",{staticClass:"h-full flex p-2"},[r("div",{class:"w-full self-center text-center text-3xl text-"+t.color+"-700"},[r("div",{domProps:{innerHTML:t._s(t.buttonHtml)}})])])])])])])},M=[],X={name:"StatusCircle",props:["color","buttonHtml","verified"]},K=X,L=Object(d["a"])(K,B,M,!1,null,"d7c1ec9e",null),U=L.exports;async function D(t){let e="0.00001",r=JSON.parse(localStorage.getItem("jwk")),n=await T.createTransaction({target:t,quantity:T.ar.arToWinston(e)},r);return n.addTag("App-Name","ArVerifyDev"),n.addTag("Type","Tip"),await T.transactions.sign(n,r),await T.transactions.post(n),n}async function z(t,e){try{let r=await axios.get(e+"/verify",{params:{address:t}});return r.data.uri}catch(r){throw console.log(r.response.data),Error(r.response.data.message)}}async function Q(t,e){try{let r=await axios({url:"https://arweave.dev/graphql",method:"post",data:{variables:{owner:t,recipient:e},query:'\n                                query transactions($owner: String!, $recipient: String!) {\n                                  transactions(\n                                    owners: [$owner]\n                                    recipients: [$recipient]\n                                    tags: [\n                                      { name: "App-Name", values: ["ArVerifyDev"] },\n                                      { name: "Type", values: ["Tip"] },\n                                    ]\n                                  ) {\n                                    edges {\n                                      node {\n                                        id\n                                        quantity {\n                                          ar\n                                        }\n                                      }\n                                    }\n                                  }\n                                }\n                                '}});console.log("TipTX: "+r.data),console.log(r.data);let n=r.data.data.transactions.edges;return n[0].node.id}catch(r){throw console.log(r),Error("No Tip Found")}}function Z(t){return axios({url:"https://arweave.dev/graphql",method:"post",data:{variables:{address:t,authNodes:["s-hGrOFm1YysWGC3wXkNaFVpyrjdinVpRKiVnhbo2so"]},query:'\n                query transactions($authNodes: [String!], $address: String!) {\n                  transactions(\n                    owners: $authNodes\n                    tags: [\n                      { name: "App-Name", values: ["ArVerifyDev"] }\n                      { name: "Type", values: ["Verification"] }\n                      { name: "Address", values: [$address] }\n                    ]\n                  ) {\n                    edges {\n                      node {\n                        id\n                        tags {\n                          name\n                          value\n                        }\n                      }\n                    }\n                  }\n                }\n                '}}).then(t=>{let e=t.data.data.transactions.edges;return e.length>0})}var tt={name:"Status",components:{StatusCircle:U},data(){return{inProgress:void 0,errored:void 0,waitingForTip:void 0,waitingForSignIn:void 0,verified:void 0,tipped:void 0,address:void 0,status:{unverified:{color:"red",statusText:"unverified",buttonHtml:"Click here to verify"},waitingForTip:{color:"orange",statusText:"verification in progess",buttonHtml:"Waiting for tip to complete"},waitingForSignIn:{color:"orange",statusText:"verification in progess",buttonHtml:"Click here to sign in"},inProgress:{color:"orange",statusText:"verification in progess",buttonHtml:"Verification is in progess"},verified:{color:"green",statusText:"verified",buttonHtml:"You are verified"},errored:{color:"red",statusText:"Verification failed",buttonHtml:"An error occurred"}}}},methods:{async waitUntilTxProcessed(t){return await new Promise(e=>{T.transactions.getStatus(t).then(r=>{if(200===r.status)e("foo");else{const r=setInterval(()=>{console.log("Waiting for "+t+"to be completed"),T.transactions.getStatus(t).then(t=>{200===t.status&&(e("foo"),clearInterval(r))})},5e3)}})})},async verify(){let t;if(this.$route.query.txId)console.log(this.$route.query.txId),this.inProgress=!0,await this.waitUntilTxProcessed(this.$route.query.txId),this.inProgress=!1;else{let t=await Z(this.address);if(!t){this.waitingForTip=!0;let t=await Q(this.address,"s-hGrOFm1YysWGC3wXkNaFVpyrjdinVpRKiVnhbo2so");if(!t){let t=await D("s-hGrOFm1YysWGC3wXkNaFVpyrjdinVpRKiVnhbo2so");await this.waitUntilTxProcessed(t.id)}console.log(t),this.waitingForTip=!1,this.tipped=!0;let e=await z(this.address,"https://9e58881ea119.ngrok.io");console.log(e),window.location=e}}t=await Z(this.address),this.verified=t}},computed:{mode(){return this.errored?this.status.errored:this.verified?this.status.verified:this.tipped?this.status.waitingForSignIn:this.waitingForTip?this.status.waitingForTip:this.inProgress?this.status.inProgress:this.status.unverified}},async mounted(){this.address=await x(),this.verified=await Z(this.address),this.tipped=await Q(this.address,"s-hGrOFm1YysWGC3wXkNaFVpyrjdinVpRKiVnhbo2so")}},et=tt,rt=Object(d["a"])(et,J,R,!1,null,"6cb2fec8",null),nt=rt.exports,at=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{staticClass:"h-64 w-full border border-dashed border-gray-500"},[r("label",{staticClass:"block w-full h-64 text-center",attrs:{for:"file-upload"}},[t._v(" Click or drag your key-file to login ")]),r("input",{staticClass:"hidden",attrs:{id:"file-upload",type:"file"},on:{change:t.addFile}})])])},it=[],st={name:"Login",methods:{addFile(t){let e=t.target.files[0],r=new FileReader;r.readAsText(e,"UTF-8"),r.onload=t=>{let e=t.target.result;try{JSON.parse(e),localStorage.setItem("jwk",e)}catch(r){alert("Sorry, your file doesn't appear to be valid JSON data.")}},location.reload()}}},ot=st,lt=Object(d["a"])(ot,at,it,!1,null,"e94180f2",null),ct=lt.exports,dt={name:"Home",components:{Login:ct,HBar:q,Status:nt,WalletInformation:Y,Navigation:k},data(){return{loggedIn:y()}}},ut=dt,ft=Object(d["a"])(ut,g,h,!1,null,"fd1b7fca",null),pt=ft.exports;n["a"].use(v["a"]);const vt=[{path:"/",name:"Home",component:pt}],gt=new v["a"]({routes:vt});var ht=gt;r("ba8c");n["a"].config.productionTip=!1,new n["a"]({router:ht,render:function(t){return t(p)}}).$mount("#app")},ba8c:function(t,e,r){}});
//# sourceMappingURL=app.4d3eae5b.js.map